{% extends 'base.html' %}
{% block title %}Listado de Tickets{% endblock %}

{% block content %}

<!------------------------------------------------------------------ FORMULARIO FILTRO TICKETS---------------------------------------------------------------------------------- -->
<h1>Listado de Tickets de mantenimiento</h1>
<form method="get" class="mb-3">
  <label>Estado:</label>
  <select name="estado">
    <option value="">Todos</option>
    {% for estado in estados %}
      <option value="{{ estado }}" {% if request.GET.estado == estado %}selected{% endif %}>{{ estado }}</option>
    {% endfor %}
  </select>

  <button type="submit">Buscar</button>
  <a href="{% url 'lista-tickets' %}">Limpiar</a>
</form>


<table>
  <thead>
    <tr>
      <th>Referencia</th>
      <th>TÃ­tulo</th>
      <th>Estado</th>
      <th>Tipo</th>
      <th>Urgencia</th>
      <th>Fecha Apertura</th>
    </tr>
  </thead>
  <tbody>
    {% for ticket in tickets %}
    <tr>
      <td>{{ ticket.referencia }}</td>
      <td>{{ ticket.titulo }}</td>
      <td>{{ ticket.estado }}</td>
      <td>{{ ticket.tipo }}</td>
      <td>{{ ticket.urgencia }}</td>
      <td>{{ ticket.fecha_apertura }}</td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="6">No se encontraron tickets con ese estado.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<a href="{% url 'home' %}">Volver</a>
{% endblock %}
